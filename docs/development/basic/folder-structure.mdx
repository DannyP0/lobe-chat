# Directory Structure

The directory structure of LobeChat is as follows:

```bash
src
├── app                 # Main application routing and pages (Next.js 15 App Router)
│   ├── (backend)       # Backend API routes and server-side logic
│   ├── [variants]      # Dynamic route variants for different UI layouts
│   ├── desktop         # Desktop-specific routes and pages
│   └── ...             # Other app router files (manifest, robots, sitemap, etc.)
├── components          # Reusable UI components
│   ├── Analytics       # Analytics and tracking components
│   ├── ChatItem        # Chat-related UI components
│   ├── Error           # Error handling and display components
│   ├── Loading         # Loading states and indicators
│   ├── client          # Client-side only components
│   └── server          # Server-side components
├── config              # Application configuration files
│   ├── featureFlags    # Feature flag configurations
│   └── modelProviders  # AI model provider configurations
├── const               # Application constants and enums
├── database            # Database-related legacy code (deprecated)
├── envs                # Environment variable definitions and validation
├── features            # Feature-specific UI modules and business logic
│   ├── AgentInfo       # Agent information and settings
│   ├── ChatInput       # Chat input functionality
│   ├── FileManager     # File management features
│   ├── ModelSelect     # AI model selection
│   └── PluginStore     # Plugin marketplace
├── helpers             # Utility helpers and tool engineering functions
├── hooks               # Custom React hooks for reusable logic
│   ├── useGreeting     # Greeting and welcome logic
│   └── useHotkeys      # Keyboard shortcut handling
├── instrumentation.ts  # Application monitoring and telemetry setup
├── layout              # Layout providers and global app structure
│   ├── AuthProvider    # Authentication providers (Clerk, NextAuth, NoAuth)
│   └── GlobalProvider  # Global state and theme providers
├── libs                # Third-party integrations and external services
│   ├── analytics       # Analytics service integrations
│   ├── clerk-auth      # Clerk authentication setup
│   ├── langchain       # LangChain integration
│   ├── mcp             # Model Context Protocol implementation
│   ├── next-auth       # NextAuth.js configuration
│   ├── oidc-provider   # OIDC provider implementation
│   └── traces          # Tracing and observability
├── locales             # Internationalization (i18n) files and utilities
├── middleware.ts       # Next.js middleware for request processing
├── migrations          # Data migration scripts and version control
│   ├── FromV0ToV1      # Migration from version 0 to 1
│   ├── FromV1ToV2      # Migration from version 1 to 2
│   └── ...             # Other version migrations
├── server              # Server-side business logic and services
│   ├── modules         # Reusable server modules (no database access)
│   ├── routers         # tRPC routers for different runtime environments
│   ├── services        # Server services with database access
│   └── utils           # Server-side utilities
├── services            # Client-side service layer for API communication
│   ├── aiModel         # AI model management services
│   ├── chat            # Chat functionality services
│   ├── electron        # Electron app-specific services
│   ├── file            # File handling services
│   ├── message         # Message management services
│   └── user            # User management services
├── store               # Zustand stores for client-side state management
│   ├── agent           # Agent-related state
│   ├── chat            # Chat state and messages
│   ├── electron        # Desktop app state
│   ├── global          # Global application state
│   └── user            # User preferences and settings
├── styles              # Global styles and theme configurations
├── tools               # Built-in tools and their implementations
│   ├── artifacts       # Code artifacts and generation
│   ├── code-interpreter # Code execution and interpretation
│   ├── dalle           # DALL-E image generation integration
│   ├── local-system    # Local system access tools
│   └── web-browsing    # Web browsing capabilities
├── types               # TypeScript type definitions
└── utils               # Common utility functions
    ├── client          # Client-side utilities
    └── server          # Server-side utilities
```

## app

In the `app` folder, we organize each route page according to the app router's [Route Groups](https://nextjs.org/docs/app/building-your-application/routing/route-groups) to separately handle the implementation of desktop and mobile code. Taking the file structure of the `welcome` page as an example:

```bash
welcome
├── (desktop)               # Desktop implementation
│   ├── features            # Desktop-specific features
│   ├── index.tsx           # Main entry file for desktop
│   └── layout.desktop.tsx  # Desktop layout component
├── (mobile)                # Mobile implementation
│   ├── features            # Mobile-specific features
│   ├── index.tsx           # Main entry file for mobile
│   └── layout.mobile.tsx   # Mobile layout component
├── features                # This folder contains features code shared by both desktop and mobile, such as the Banner component
│   └── Banner
└── page.tsx                # This is the main entry file for the page, used to load desktop or mobile code based on the device type
```

In this way, we can clearly distinguish and manage desktop and mobile code, while also easily reusing code required on both devices, thereby improving development efficiency and maintaining code cleanliness and maintainability.
